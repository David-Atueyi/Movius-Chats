{"version":3,"file":"MessageContent.js","sources":["../../../../src/components/ChatBubble/MessageContent.tsx"],"sourcesContent":["import React from 'react';\nimport { Image, Pressable, Text, View } from 'react-native';\nimport Video, { VideoRef } from 'react-native-video';\nimport tw from 'twrnc';\nimport { LoadingIcon } from '../../assets/Icons/LoadingIcon';\nimport { PlayIcon } from '../../assets/Icons/PlayIcon';\nimport { useChatContext } from '../../context/ChatContext';\nimport { formatDuration } from '../../utils/datefunc';\nimport AudioPlayer from '../AudioPlayer/AudioPlayer';\nimport { MessageContentProps } from './types';\n\nconst MessageContent: React.FC<MessageContentProps> = ({\n  message,\n  onMediaPress,\n  isVideoPlaying,\n  isCurrentUser,\n}) => {\n  const {\n    theme,\n    showMessageStatus,\n    CustomPlayIcon,\n    renderCustomVideoBubbleError,\n  } = useChatContext();\n  const videoRef = React.useRef<VideoRef>(null);\n  const [duration, setDuration] = React.useState(0);\n  const [videoIsLoading, setVideoIsLoading] = React.useState(false);\n  const [videoHasError, setVideoHasError] = React.useState(false);\n\n  return (\n    <View>\n      {message.image && (\n        <Pressable\n          onPress={() => onMediaPress('image', message.image as string)}\n          style={tw`w-60 h-80 my-2`}\n        >\n          <Image\n            source={{ uri: message.image }}\n            style={tw`w-full h-full object-contain rounded-lg`}\n          />\n        </Pressable>\n      )}\n\n      {message.video && (\n        <Pressable\n          onPress={() => onMediaPress('video', message.video as string)}\n          style={tw`w-60 h-80 my-2 justify-center items-center`}\n          disabled={videoIsLoading}\n        >\n          <Video\n            source={{ uri: message.video }}\n            ref={videoRef}\n            paused={true}\n            style={{\n              width: '100%',\n              height: '100%',\n              borderRadius: 8,\n              position: 'relative',\n            }}\n            resizeMode=\"cover\"\n            onLoadStart={() => {\n              setVideoIsLoading(true);\n              setVideoHasError(false);\n            }}\n            onLoad={(data) => {\n              setDuration(data.duration);\n              setVideoIsLoading(false);\n            }}\n            onBuffer={({ isBuffering }) => setVideoIsLoading(isBuffering)}\n            onError={() => {\n              setVideoHasError(true);\n              setVideoIsLoading(false);\n            }}\n          />\n          {videoIsLoading ? (\n            <View\n              style={tw`absolute inset-0 flex items-center justify-center bg-black/40 rounded-full`}\n            >\n              <LoadingIcon\n                style={tw.style('h-12 w-12 fill-white animate-spin')}\n              />\n            </View>\n          ) : videoHasError ? (\n            renderCustomVideoBubbleError ? (\n              renderCustomVideoBubbleError()\n            ) : (\n              <View\n                style={tw`absolute inset-0 flex items-center justify-center bg-red-500/60 p-2`}\n              >\n                <Text style={tw`text-white font-bold`}>\n                  Failed to load video\n                </Text>\n              </View>\n            )\n          ) : (\n            <>\n              <View style={tw`absolute bg-black/40 rounded-full`}>\n                {CustomPlayIcon ? (\n                  <CustomPlayIcon />\n                ) : (\n                  <PlayIcon\n                    style={tw.style('h-16 w-16')}\n                    color={theme?.colors?.audioPlayIconColor || 'white'}\n                  />\n                )}\n              </View>\n              <View\n                style={tw`absolute bottom-2 left-2 bg-black/50 px-2 py-1 rounded-md`}\n              >\n                <Text style={tw`text-white text-xs font-semibold`}>\n                  {formatDuration(duration)}\n                </Text>\n              </View>\n            </>\n          )}\n        </Pressable>\n      )}\n\n      {message.audio && (\n        <View style={tw`my-2`}>\n          <AudioPlayer\n            audioUrl={message.audio}\n            audioId={message.id}\n            isVideoPlaying={isVideoPlaying as boolean}\n          />\n        </View>\n      )}\n\n      {message.text && (\n        <Text\n          style={[\n            tw`pt-1`,\n            showMessageStatus ? tw`pb-0` : tw`pb-2`,\n            { wordBreak: 'break-word', overflowWrap: 'break-word' },\n            isCurrentUser\n              ? theme?.messageStyle?.sentTextStyle\n              : theme?.messageStyle?.receivedTextStyle,\n          ]}\n        >\n          {message.text}\n        </Text>\n      )}\n    </View>\n  );\n};\n\nexport default React.memo(MessageContent);\n"],"names":["MessageContent","message","onMediaPress","isVideoPlaying","isCurrentUser","theme","showMessageStatus","CustomPlayIcon","renderCustomVideoBubbleError","useChatContext","videoRef","React","useRef","duration","setDuration","useState","videoIsLoading","setVideoIsLoading","videoHasError","setVideoHasError","_jsxs","View","children","image","_jsx","Pressable","onPress","style","tw","Image","source","uri","video","disabled","Video","ref","paused","width","height","borderRadius","position","resizeMode","onLoadStart","onLoad","data","onBuffer","isBuffering","onError","LoadingIcon","Text","_Fragment","PlayIcon","color","colors","audioPlayIconColor","formatDuration","audio","AudioPlayer","audioUrl","audioId","id","text","wordBreak","overflowWrap","messageStyle","sentTextStyle","receivedTextStyle","MessageContent$1","memo"],"mappings":"kfAWA,MAAMA,EAAgDA,EACpDC,UACAC,eACAC,iBACAC,oBAEA,MAAMC,MACJA,EAAKC,kBACLA,EAAiBC,eACjBA,EAAcC,6BACdA,GACEC,IACEC,EAAWC,EAAMC,OAAiB,OACjCC,EAAUC,GAAeH,EAAMI,SAAS,IACxCC,EAAgBC,GAAqBN,EAAMI,UAAS,IACpDG,EAAeC,GAAoBR,EAAMI,UAAS,GAEzD,OACEK,EAACC,EAAI,CAAAC,UACFrB,EAAQsB,OACPC,EAACC,EAAS,CACRC,QAASA,IAAMxB,EAAa,QAASD,EAAQsB,OAC7CI,MAAOC,CAAE,iBAAiBN,SAE1BE,EAACK,EAAK,CACJC,OAAQ,CAAEC,IAAK9B,EAAQsB,OACvBI,MAAOC,CAAE,8CAKd3B,EAAQ+B,OACPZ,EAACK,EAAS,CACRC,QAASA,IAAMxB,EAAa,QAASD,EAAQ+B,OAC7CL,MAAOC,CAAE,6CACTK,SAAUjB,EAAeM,SAAA,CAEzBE,EAACU,EAAK,CACJJ,OAAQ,CAAEC,IAAK9B,EAAQ+B,OACvBG,IAAKzB,EACL0B,QAAQ,EACRT,MAAO,CACLU,MAAO,OACPC,OAAQ,OACRC,aAAc,EACdC,SAAU,YAEZC,WAAW,QACXC,YAAaA,KACXzB,GAAkB,GAClBE,GAAiB,EAAM,EAEzBwB,OAASC,IACP9B,EAAY8B,EAAK/B,UACjBI,GAAkB,EAAM,EAE1B4B,SAAUA,EAAGC,iBAAkB7B,EAAkB6B,GACjDC,QAASA,KACP5B,GAAiB,GACjBF,GAAkB,EAAM,IAG3BD,EACCQ,EAACH,EAAI,CACHM,MAAOC,CAAE,6EAA6EN,SAEtFE,EAACwB,EAAW,CACVrB,MAAOC,EAAGD,MAAM,yCAGlBT,EACFV,EACEA,IAEAgB,EAACH,EAAI,CACHM,MAAOC,CAAE,sEAAsEN,SAE/EE,EAACyB,EAAI,CAACtB,MAAOC,CAAE,uBAAuBN,SAAC,2BAM3CF,EAAA8B,EAAA,CAAA5B,SAAA,CACEE,EAACH,EAAI,CAACM,MAAOC,CAAE,oCAAoCN,SAChDf,EACCiB,EAACjB,EAAc,CAAA,GAEfiB,EAAC2B,EAAQ,CACPxB,MAAOC,EAAGD,MAAM,aAChByB,MAAO/C,GAAOgD,QAAQC,oBAAsB,YAIlD9B,EAACH,EAAI,CACHM,MAAOC,CAAE,4DAA4DN,SAErEE,EAACyB,EAAI,CAACtB,MAAOC,CAAE,mCAAmCN,SAC/CiC,EAAe1C,aAQ3BZ,EAAQuD,OACPhC,EAACH,EAAI,CAACM,MAAOC,CAAE,OAAON,SACpBE,EAACiC,EAAW,CACVC,SAAUzD,EAAQuD,MAClBG,QAAS1D,EAAQ2D,GACjBzD,eAAgBA,MAKrBF,EAAQ4D,MACPrC,EAACyB,EAAI,CACHtB,MAAO,CACLC,CAAE,OACFtB,EAAoBsB,CAAE,OAASA,CAAE,OACjC,CAAEkC,UAAW,aAAcC,aAAc,cACzC3D,EACIC,GAAO2D,cAAcC,cACrB5D,GAAO2D,cAAcE,mBACzB5C,SAEDrB,EAAQ4D,SAGR,EAIX,IAAAM,EAAexD,EAAMyD,KAAKpE"}