{"version":3,"file":"ChatInput.js","sources":["../../../../src/components/ChatInput/ChatInput.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { Platform, Pressable, TextInput, View } from 'react-native';\nimport tw from 'twrnc';\nimport { CameraIcon } from '../../assets/Icons/CameraIcon';\nimport { EmojiFunnySquareIcon } from '../../assets/Icons/EmojiFunnySquareIcon';\nimport { MicrophoneIcon } from '../../assets/Icons/MicrophoneIcon';\nimport { PaperClipIcon } from '../../assets/Icons/PaperClipIcon';\nimport { PaperPlaneIcon } from '../../assets/Icons/PaperPlaneIcon';\nimport { useChatContext } from '../../context/ChatContext';\nimport FilePreview from './FilePreview';\nimport { ChatInputProps, InputHeightState } from './types';\n\nconst MIN_INPUT_HEIGHT = Platform.OS === 'ios' ? 32 : 30;\nconst MAX_INPUT_HEIGHT = 118;\n\nconst ChatInput: React.FC<ChatInputProps> = ({\n  onSendMessage,\n  onTypingStart,\n  onTypingEnd,\n  onAttachmentPress,\n  onCameraPress,\n  onAudioRecordStart,\n  onAudioRecordEnd,\n  CustomEmojiIcon,\n  CustomAttachmentIcon,\n  CustomCameraIcon,\n  CustomSendIcon,\n  CustomMicrophoneIcon,\n  CustomFileIcon,\n  CustomImagePreview,\n  CustomVideoPreview,\n}) => {\n  const [inputText, setInputText] = useState('');\n  const [inputHeight, setInputHeight] = useState<InputHeightState>({\n    height: MIN_INPUT_HEIGHT,\n    isMultiline: false,\n  });\n  const {\n    theme,\n    currentUserId,\n    showEmojiButton,\n    showAttachmentsButton,\n    showCameraButton,\n    showVoiceRecordButton,\n    placeholder,\n    previewData,\n    closePreview,\n  } = useChatContext();\n\n  const handleContentSizeChange = useCallback(\n    (event: { nativeEvent: { contentSize: { height: number } } }) => {\n      const newHeight = Math.min(\n        Math.max(event.nativeEvent.contentSize.height, MIN_INPUT_HEIGHT),\n        MAX_INPUT_HEIGHT\n      );\n      setInputHeight({\n        height: newHeight,\n        isMultiline: newHeight > MIN_INPUT_HEIGHT,\n      });\n    },\n    []\n  );\n\n  const handleSendMessage = useCallback(() => {\n    const trimmedText = inputText.trim();\n\n    if (!trimmedText && !previewData) {\n      return;\n    }\n\n    onSendMessage({\n      text: trimmedText,\n      senderId: currentUserId,\n    });\n\n    setInputText('');\n    setInputHeight({ height: MIN_INPUT_HEIGHT, isMultiline: false });\n  }, [inputText, onSendMessage, currentUserId, previewData]);\n\n  useEffect(() => {\n    if (inputText.trim()) {\n      onTypingStart?.();\n    } else {\n      onTypingEnd?.();\n    }\n  }, [inputText, onTypingStart, onTypingEnd]);\n\n  return (\n    <View\n      style={[\n        tw`flex-row gap-2`,\n        theme?.inputStyles?.inputSectionContainerStyle,\n      ]}\n    >\n      {/* File Preview above the input */}\n      {previewData && (\n        <FilePreview\n          previewData={previewData}\n          closePreview={closePreview}\n          CustomFileIcon={CustomFileIcon}\n          CustomImagePreview={CustomImagePreview}\n          CustomVideoPreview={CustomVideoPreview}\n        />\n      )}\n      <View\n        style={[\n          tw`flex-1 bg-white px-3.5 gap-1 flex-row justify-between`,\n          inputHeight.isMultiline\n            ? tw`rounded-3xl items-end`\n            : tw`rounded-full items-center`,\n          theme?.inputStyles?.inputContainerStyle,\n        ]}\n      >\n        {showEmojiButton && (\n          <Pressable>\n            {CustomEmojiIcon ? (\n              <CustomEmojiIcon />\n            ) : (\n              <EmojiFunnySquareIcon\n                style={tw.style(\n                  `${Platform.OS === 'ios' ? 'h-6 w-6' : 'w-7 h-7'}`,\n                  inputHeight.isMultiline ? 'pb-14' : 'pb-0'\n                )}\n                color={theme?.colors?.inputsIconsColor || 'rgba(0,0,0,0.7)'}\n              />\n            )}\n          </Pressable>\n        )}\n\n        <TextInput\n          value={inputText}\n          onChangeText={setInputText}\n          placeholder={placeholder || 'Message'}\n          style={[\n            tw`bg-transparent flex-1 pl-2 my-3`,\n            Platform.OS === 'ios' ? tw`text-[17px]` : tw`text-[16px]`,\n            { minHeight: MIN_INPUT_HEIGHT, maxHeight: MAX_INPUT_HEIGHT },\n          ]}\n          placeholderTextColor={\n            theme?.colors?.placeholderTextColor || 'rgba(0, 0, 0, 0.4)'\n          }\n          multiline\n          textAlignVertical=\"center\"\n          onContentSizeChange={handleContentSizeChange}\n        />\n\n        <View\n          style={[\n            tw`gap-4 flex-row`,\n            inputHeight.isMultiline ? tw`pb-4` : tw`pb-0`,\n          ]}\n        >\n          {showAttachmentsButton && (\n            <Pressable onPress={onAttachmentPress}>\n              {CustomAttachmentIcon ? (\n                <CustomAttachmentIcon />\n              ) : (\n                <PaperClipIcon\n                  style={tw.style(\n                    Platform.OS === 'ios' ? 'h-6 w-6' : 'w-7 h-7'\n                  )}\n                  color={theme?.colors?.inputsIconsColor || 'rgba(0,0,0,0.7)'}\n                />\n              )}\n            </Pressable>\n          )}\n          {showCameraButton && !inputText.trim() && (\n            <Pressable onPress={onCameraPress}>\n              {CustomCameraIcon ? (\n                <CustomCameraIcon />\n              ) : (\n                <CameraIcon\n                  style={tw.style(\n                    Platform.OS === 'ios' ? 'h-6 w-6' : 'w-7 h-7'\n                  )}\n                  color={theme?.colors?.inputsIconsColor || 'rgba(0,0,0,0.7)'}\n                />\n              )}\n            </Pressable>\n          )}\n        </View>\n      </View>\n\n      <Pressable\n        style={[\n          tw`p-2 rounded-full bg-green-600 justify-center items-center`,\n          {\n            height: Platform.OS === 'ios' ? 50 : 48,\n            width: Platform.OS === 'ios' ? 50 : 48,\n            ...theme?.inputStyles?.sendButtonStyle,\n          },\n        ]}\n        onPress={\n          inputText.trim() || previewData\n            ? handleSendMessage\n            : onAudioRecordStart\n        }\n        onLongPress={onAudioRecordStart}\n        onPressOut={onAudioRecordEnd}\n      >\n        {inputText.trim() ? (\n          CustomSendIcon ? (\n            <CustomSendIcon />\n          ) : (\n            <PaperPlaneIcon\n              style={tw.style('h-6 w-6')}\n              color={theme?.colors?.sendIconsColor || 'rgba(255,255,255,0.7)'}\n            />\n          )\n        ) : showVoiceRecordButton ? (\n          CustomMicrophoneIcon ? (\n            <CustomMicrophoneIcon />\n          ) : (\n            <MicrophoneIcon\n              style={tw.style('h-8 w-8')}\n              color={theme?.colors?.sendIconsColor || 'rgba(255,255,255,0.7)'}\n            />\n          )\n        ) : CustomSendIcon ? (\n          <CustomSendIcon />\n        ) : (\n          <PaperPlaneIcon\n            style={tw.style('h-6 w-6')}\n            color={theme?.colors?.sendIconsColor || 'rgba(255,255,255,0.7)'}\n          />\n        )}\n      </Pressable>\n    </View>\n  );\n};\n\nexport default React.memo(ChatInput);\n"],"names":["MIN_INPUT_HEIGHT","Platform","OS","ChatInput","onSendMessage","onTypingStart","onTypingEnd","onAttachmentPress","onCameraPress","onAudioRecordStart","onAudioRecordEnd","CustomEmojiIcon","CustomAttachmentIcon","CustomCameraIcon","CustomSendIcon","CustomMicrophoneIcon","CustomFileIcon","CustomImagePreview","CustomVideoPreview","inputText","setInputText","useState","inputHeight","setInputHeight","height","isMultiline","theme","currentUserId","showEmojiButton","showAttachmentsButton","showCameraButton","showVoiceRecordButton","placeholder","previewData","closePreview","useChatContext","handleContentSizeChange","useCallback","event","newHeight","Math","min","max","nativeEvent","contentSize","handleSendMessage","trimmedText","trim","text","senderId","useEffect","_jsxs","View","style","tw","inputStyles","inputSectionContainerStyle","children","_jsx","FilePreview","inputContainerStyle","Pressable","EmojiFunnySquareIcon","color","colors","inputsIconsColor","TextInput","value","onChangeText","minHeight","maxHeight","placeholderTextColor","multiline","textAlignVertical","onContentSizeChange","onPress","PaperClipIcon","CameraIcon","width","sendButtonStyle","onLongPress","onPressOut","PaperPlaneIcon","sendIconsColor","MicrophoneIcon","ChatInput$1","React","memo"],"mappings":"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"}