"use strict";var e=require("react"),t=require("react-native"),s=require("react-native-reanimated"),r=require("react-native-sound"),n=require("twrnc"),a=require("../../assets/Icons/PauseIcon.js"),o=require("../../assets/Icons/PlayIcon.js"),u=require("../../context/AudioContext.js"),i=require("../../context/ChatContext.js"),l=require("../../utils/datefunc.js"),c=require("react/jsx-runtime");const d={code:"function AudioPlayerTsx1(){const{knobPosition}=this.__closure;return{transform:[{translateX:knobPosition.value}]};}",location:"/home/eadav/Documents/packages/Movius-Chats/src/components/AudioPlayer/AudioPlayer.tsx",sourceMap:'{"version":3,"names":["AudioPlayerTsx1","knobPosition","__closure","transform","translateX","value"],"sources":["/home/eadav/Documents/packages/Movius-Chats/src/components/AudioPlayer/AudioPlayer.tsx"],"mappings":"AAoIyC,SAAAA,eAAMA,CAAA,QAAAC,YAAA,OAAAC,SAAA,CAC3C,MAAO,CACLC,SAAS,CAAE,CAAC,CAAEC,UAAU,CAAEH,YAAY,CAACI,KAAM,CAAC,CAChD,CAAC,CACH","ignoreList":[]}',version:"3.16.7"},A=({audioUrl:A,audioId:y,isVideoPlaying:h})=>{const{theme:C,CustomPlayIcon:p,CustomPauseIcon:m}=i.useChatContext(),{currentlyPlayingId:v,setCurrentlyPlayingId:f}=u.useAudio(),[P,g]=e.useState(null),[x,w]=e.useState(!1),[S,j]=e.useState(0),[b,I]=e.useState(0),[R,_]=e.useState(!1),q=e.useRef(null),E=e.useRef(0),k=e.useRef(0),M=e.useRef(0),N=s.useSharedValue(0);e.useEffect((()=>{let e=!0;const t=new r(A,"",(s=>{!s&&e&&I(t.getDuration())}));return g(t),()=>{e=!1,t&&(t.pause(),t.release())}}),[A]),e.useEffect((()=>{v&&v!==y&&x&&P&&(P.pause(),w(!1),j(0),N.value=0)}),[v,y,x,P]),e.useEffect((()=>{let e;return x&&P&&!R&&(e=setInterval((()=>{P.getCurrentTime((e=>{if("number"==typeof e&&!isNaN(e)&&(j(e),E.current>0&&b>0)){const t=e/b*E.current;isNaN(t)||(N.value=s.withSpring(t,{damping:15,stiffness:100}))}}))}),100)),()=>{e&&clearInterval(e)}}),[x,P,R,b]);const D=t.PanResponder.create({onStartShouldSetPanResponder:()=>!0,onMoveShouldSetPanResponder:()=>!0,onPanResponderGrant:e=>{_(!0),M.current=e.nativeEvent.pageX-N.value},onPanResponderMove:e=>{if(E.current>0){const t=e.nativeEvent.pageX-M.current,s=Math.max(0,Math.min(t,E.current));N.value=s;const r=s/E.current*b;isNaN(r)||j(r)}},onPanResponderRelease:()=>{if(_(!1),P&&E.current>0){const e=N.value/E.current*b;isNaN(e)||P.setCurrentTime(e)}},onPanResponderTerminate:()=>{_(!1)}}),V=s.useAnimatedStyle(function(){const e=[new global.Error,-2,-27],t=function(){return{transform:[{translateX:N.value}]}};return t.__closure={knobPosition:N},t.__workletHash=1935336866997,t.__initData=d,t.__stackDetails=e,t}());return e.useEffect((()=>{h&&x&&P&&P.pause((()=>{w(!1),f(null)}))}),[h]),c.jsxs(t.View,{style:n`rounded-lg w-56`,children:[c.jsxs(t.View,{style:n`flex-row items-center gap-2 px-2 pt-2`,children:[c.jsx(t.Pressable,{onPress:()=>{P&&(x?P.pause((()=>{w(!1),f(null)})):(f(y),P.play((e=>{e&&(w(!1),j(0),N.value=s.withSpring(0),f(null))})),w(!0)))},style:[n`bg-black/40 rounded-full p-2`,C?.messageStyle?.audioPlayButtonStyle],children:x?m?c.jsx(m,{}):c.jsx(a.PauseIcon,{style:n.style("h-6 w-6"),color:C?.colors?.audioPauseIconColor||"white"}):p?c.jsx(p,{}):c.jsx(o.PlayIcon,{style:n.style("h-6 w-6"),color:C?.colors?.audioPlayIconColor||"white"})}),c.jsxs(t.View,{ref:q,onLayout:e=>{const{width:t}=e.nativeEvent.layout;E.current=t,q.current?.measure(((e,t,s,r,n)=>{k.current=n}))},style:[n`relative h-1 bg-zinc-400 rounded overflow-visible w-[75%]`,C?.messageStyle?.progressBarStyle],children:[c.jsx(t.View,{style:[n`absolute h-full bg-slate-200`,{width:(b>0?S/b*100:0)+"%"},C?.messageStyle?.activeProgressBarStyle]}),c.jsx(s.View,{...D.panHandlers,style:[V,{position:"absolute",top:-6,width:16,height:16,borderRadius:8,backgroundColor:"white",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5},{...C?.messageStyle?.audioKnobStyle}]})]})]}),c.jsx(t.View,{style:n`px-4 py-1`,children:c.jsx(t.Text,{style:[n`text-xs text-gray-500`,C?.messageStyle?.audioDurationStyle],children:isNaN(S)?"0:00":l.formatDuration(S)})})]})};var y=e.memo(A);module.exports=y;
//# sourceMappingURL=AudioPlayer.js.map
