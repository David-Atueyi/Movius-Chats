{"version":3,"file":"MessageContent.js","sources":["../../../../src/components/ChatBubble/MessageContent.tsx"],"sourcesContent":["import React from 'react';\nimport { Image, Pressable, Text, View } from 'react-native';\nimport Video, { VideoRef } from 'react-native-video';\nimport tw from 'twrnc';\nimport { LoadingIcon } from '../../assets/Icons/LoadingIcon';\nimport { PlayIcon } from '../../assets/Icons/PlayIcon';\nimport { useChatContext } from '../../context/ChatContext';\nimport { formatDuration } from '../../utils/datefunc';\nimport AudioPlayer from '../AudioPlayer/AudioPlayer';\nimport { MessageContentProps } from './types';\n\nconst MessageContent: React.FC<MessageContentProps> = ({\n  message,\n  onMediaPress,\n  isVideoPlaying,\n  isCurrentUser,\n}) => {\n  const {\n    theme,\n    showMessageStatus,\n    CustomPlayIcon,\n    renderCustomVideoBubbleError,\n  } = useChatContext();\n  const videoRef = React.useRef<VideoRef>(null);\n  const [duration, setDuration] = React.useState(0);\n  const [videoIsLoading, setVideoIsLoading] = React.useState(false);\n  const [videoHasError, setVideoHasError] = React.useState(false);\n\n  return (\n    <View>\n      {message.image && (\n        <Pressable\n          onPress={() => onMediaPress('image', message.image as string)}\n          style={tw`w-60 h-80 my-2`}\n        >\n          <Image\n            source={{ uri: message.image }}\n            style={tw`w-full h-full rounded-lg`}\n            resizeMode=\"contain\"\n          />\n        </Pressable>\n      )}\n\n      {message.video && (\n        <Pressable\n          onPress={() => onMediaPress('video', message.video as string)}\n          style={tw`w-60 h-80 my-2 justify-center items-center`}\n          disabled={videoIsLoading}\n        >\n          <Video\n            source={{ uri: message.video }}\n            ref={videoRef}\n            paused={true}\n            style={{\n              width: '100%',\n              height: '100%',\n              borderRadius: 8,\n              position: 'relative',\n            }}\n            resizeMode=\"cover\"\n            onLoadStart={() => {\n              setVideoIsLoading(true);\n              setVideoHasError(false);\n            }}\n            onLoad={(data) => {\n              setDuration(data.duration);\n              setVideoIsLoading(false);\n            }}\n            onBuffer={({ isBuffering }) => setVideoIsLoading(isBuffering)}\n            onError={() => {\n              setVideoHasError(true);\n              setVideoIsLoading(false);\n            }}\n          />\n          {videoIsLoading ? (\n            <View\n              style={tw`absolute inset-0 flex items-center justify-center bg-black/40 rounded-full`}\n            >\n              <LoadingIcon style={tw.style('h-12 w-12')} spinning />\n            </View>\n          ) : videoHasError ? (\n            renderCustomVideoBubbleError ? (\n              renderCustomVideoBubbleError()\n            ) : (\n              <View\n                style={tw`absolute inset-0 flex items-center justify-center bg-red-500/60 p-2`}\n              >\n                <Text style={tw`text-white font-bold`}>\n                  Failed to load video\n                </Text>\n              </View>\n            )\n          ) : (\n            <>\n              <View style={tw`absolute bg-black/40 rounded-full`}>\n                {CustomPlayIcon ? (\n                  <CustomPlayIcon />\n                ) : (\n                  <PlayIcon\n                    style={tw.style('h-16 w-16')}\n                    color={theme?.colors?.audioPlayIconColor || 'white'}\n                  />\n                )}\n              </View>\n              <View\n                style={tw`absolute bottom-2 left-2 bg-black/50 px-2 py-1 rounded-md`}\n              >\n                <Text style={tw`text-white text-xs font-semibold`}>\n                  {formatDuration(duration)}\n                </Text>\n              </View>\n            </>\n          )}\n        </Pressable>\n      )}\n\n      {message.audio && (\n        <View style={tw`my-2`}>\n          <AudioPlayer\n            audioUrl={message.audio}\n            audioId={message.id}\n            isVideoPlaying={isVideoPlaying as boolean}\n          />\n        </View>\n      )}\n\n      {message.text && (\n        <Text\n          style={[\n            tw`pt-1`,\n            showMessageStatus ? tw`pb-0` : tw`pb-2`,\n            { wordBreak: 'break-word', overflowWrap: 'break-word' },\n            isCurrentUser\n              ? theme?.messageStyle?.sentTextStyle\n              : theme?.messageStyle?.receivedTextStyle,\n          ]}\n        >\n          {message.text}\n        </Text>\n      )}\n    </View>\n  );\n};\n\nexport default React.memo(MessageContent);\n"],"names":["MessageContent","message","onMediaPress","isVideoPlaying","isCurrentUser","theme","showMessageStatus","CustomPlayIcon","renderCustomVideoBubbleError","useChatContext","videoRef","React","useRef","duration","setDuration","useState","videoIsLoading","setVideoIsLoading","videoHasError","setVideoHasError","_jsxs","View","children","image","_jsx","Pressable","onPress","style","tw","jsx","Image","source","uri","resizeMode","video","disabled","Video","ref","paused","width","height","borderRadius","position","onLoadStart","onLoad","data","onBuffer","isBuffering","onError","LoadingIcon","spinning","Text","jsxs","_Fragment","PlayIcon","color","colors","audioPlayIconColor","formatDuration","audio","AudioPlayer","audioUrl","audioId","id","text","wordBreak","overflowWrap","messageStyle","sentTextStyle","receivedTextStyle","MessageContent$1","memo"],"mappings":"qWAWA,MAAMA,EAAgDA,EACpDC,UACAC,eACAC,iBACAC,oBAEA,MAAMC,MACJA,EAAKC,kBACLA,EAAiBC,eACjBA,EAAcC,6BACdA,GACEC,mBACEC,EAAWC,EAAMC,OAAiB,OACjCC,EAAUC,GAAeH,EAAMI,SAAS,IACxCC,EAAgBC,GAAqBN,EAAMI,UAAS,IACpDG,EAAeC,GAAoBR,EAAMI,UAAS,GAEzD,OACEK,EAAAA,KAACC,EAAAA,KAAI,CAAAC,UACFrB,EAAQsB,OACPC,EAAAA,IAACC,EAAAA,UAAS,CACRC,QAASA,IAAMxB,EAAa,QAASD,EAAQsB,OAC7CI,MAAOC,CAAE,iBAAiBN,SAE1BE,EAAAK,IAACC,QAAK,CACJC,OAAQ,CAAEC,IAAK/B,EAAQsB,OACvBI,MAAOC,CAAE,2BACTK,WAAW,cAKhBhC,EAAQiC,OACPd,EAAAA,KAACK,EAAAA,UAAS,CACRC,QAASA,IAAMxB,EAAa,QAASD,EAAQiC,OAC7CP,MAAOC,CAAE,6CACTO,SAAUnB,EAAeM,SAAA,CAEzBE,EAAAK,IAACO,EAAK,CACJL,OAAQ,CAAEC,IAAK/B,EAAQiC,OACvBG,IAAK3B,EACL4B,QAAQ,EACRX,MAAO,CACLY,MAAO,OACPC,OAAQ,OACRC,aAAc,EACdC,SAAU,YAEZT,WAAW,QACXU,YAAaA,KACX1B,GAAkB,GAClBE,GAAiB,EAAM,EAEzByB,OAASC,IACP/B,EAAY+B,EAAKhC,UACjBI,GAAkB,EAAM,EAE1B6B,SAAUA,EAAGC,iBAAkB9B,EAAkB8B,GACjDC,QAASA,KACP7B,GAAiB,GACjBF,GAAkB,EAAM,IAG3BD,EACCQ,EAAAK,IAACR,OAAI,CACHM,MAAOC,CAAE,6EAA6EN,SAEtFE,EAAAK,IAACoB,cAAW,CAACtB,MAAOC,EAAGD,MAAM,aAAcuB,UAAQ,MAEnDhC,EACFV,EACEA,IAEAgB,EAAAA,IAACH,EAAAA,KAAI,CACHM,MAAOC,CAAE,sEAAsEN,SAE/EE,EAAAK,IAACsB,OAAI,CAACxB,MAAOC,CAAE,uBAAuBN,SAAC,2BAM3CF,EAAAgC,KAAAC,WAAA,CAAA/B,SAAA,CACEE,EAAAK,IAACR,OAAI,CAACM,MAAOC,CAAE,oCAAoCN,SAChDf,EACCiB,MAACjB,EAAc,CAAA,GAEfiB,EAAAK,IAACyB,WAAQ,CACP3B,MAAOC,EAAGD,MAAM,aAChB4B,MAAOlD,GAAOmD,QAAQC,oBAAsB,YAIlDjC,EAAAK,IAACR,OAAI,CACHM,MAAOC,CAAE,4DAA4DN,SAErEE,EAAAK,IAACsB,OAAI,CAACxB,MAAOC,CAAE,mCAAmCN,SAC/CoC,EAAcA,eAAC7C,aAQ3BZ,EAAQ0D,OACPnC,EAAAA,IAACH,EAAAA,KAAI,CAACM,MAAOC,CAAE,OAAON,SACpBE,EAAAK,IAAC+B,EAAW,CACVC,SAAU5D,EAAQ0D,MAClBG,QAAS7D,EAAQ8D,GACjB5D,eAAgBA,MAKrBF,EAAQ+D,MACPxC,EAAAA,IAAC2B,EAAAA,KAAI,CACHxB,MAAO,CACLC,CAAE,OACFtB,EAAoBsB,CAAE,OAASA,CAAE,OACjC,CAAEqC,UAAW,aAAcC,aAAc,cACzC9D,EACIC,GAAO8D,cAAcC,cACrB/D,GAAO8D,cAAcE,mBACzB/C,SAEDrB,EAAQ+D,SAGR,EAIX,IAAAM,EAAe3D,EAAM4D,KAAKvE"}