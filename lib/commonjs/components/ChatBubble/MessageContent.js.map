{"version":3,"file":"MessageContent.js","sources":["../../../../src/components/ChatBubble/MessageContent.tsx"],"sourcesContent":["import React from 'react';\nimport { Image, Pressable, Text, View } from 'react-native';\nimport Video, { VideoRef } from 'react-native-video';\nimport tw from 'twrnc';\nimport { LoadingIcon } from '../../assets/Icons/LoadingIcon';\nimport { PlayIcon } from '../../assets/Icons/PlayIcon';\nimport { useChatContext } from '../../context/ChatContext';\nimport { formatDuration } from '../../utils/datefunc';\nimport AudioPlayer from '../AudioPlayer/AudioPlayer';\nimport { MessageContentProps } from './types';\n\nconst MessageContent: React.FC<MessageContentProps> = ({\n  message,\n  onMediaPress,\n  isVideoPlaying,\n}) => {\n  const {\n    theme,\n    showMessageStatus,\n    CustomPlayIcon,\n    renderCustomVideoBubbleError,\n  } = useChatContext();\n  const videoRef = React.useRef<VideoRef>(null);\n  const [duration, setDuration] = React.useState(0);\n  const [videoIsLoading, setVideoIsLoading] = React.useState(false);\n  const [videoHasError, setVideoHasError] = React.useState(false);\n\n  return (\n    <View>\n      {message.image && (\n        <Pressable\n          onPress={() => onMediaPress('image', message.image as string)}\n          style={tw`w-60 h-80 my-2`}\n        >\n          <Image\n            source={{ uri: message.image }}\n            style={tw`w-full h-full object-contain rounded-lg`}\n          />\n        </Pressable>\n      )}\n\n      {message.video && (\n        <Pressable\n          onPress={() => onMediaPress('video', message.video as string)}\n          style={tw`w-60 h-80 my-2 justify-center items-center`}\n          disabled={videoIsLoading}\n        >\n          <Video\n            source={{ uri: message.video }}\n            ref={videoRef}\n            paused={true}\n            style={{\n              width: '100%',\n              height: '100%',\n              borderRadius: 8,\n              position: 'relative',\n            }}\n            resizeMode=\"cover\"\n            onLoadStart={() => {\n              setVideoIsLoading(true);\n              setVideoHasError(false);\n            }}\n            onLoad={(data) => {\n              setDuration(data.duration);\n              setVideoIsLoading(false);\n            }}\n            onBuffer={({ isBuffering }) => setVideoIsLoading(isBuffering)}\n            onError={() => {\n              setVideoHasError(true);\n              setVideoIsLoading(false);\n            }}\n          />\n          {videoIsLoading ? (\n            <View\n              style={tw`absolute inset-0 flex items-center justify-center bg-black/40 rounded-full`}\n            >\n              <LoadingIcon\n                style={tw.style('h-12 w-12 fill-white animate-spin')}\n              />\n            </View>\n          ) : videoHasError ? (\n            renderCustomVideoBubbleError ? (\n              renderCustomVideoBubbleError()\n            ) : (\n              <View\n                style={tw`absolute inset-0 flex items-center justify-center bg-red-500/60 p-2`}\n              >\n                <Text style={tw`text-white font-bold`}>\n                  Failed to load video\n                </Text>\n              </View>\n            )\n          ) : (\n            <>\n              <View style={tw`absolute bg-black/40 rounded-full`}>\n                {CustomPlayIcon ? (\n                  <CustomPlayIcon />\n                ) : (\n                  <PlayIcon\n                    style={tw.style('h-16 w-16')}\n                    color={theme?.colors?.audioPlayIconColor || 'white'}\n                  />\n                )}\n              </View>\n              <View\n                style={tw`absolute bottom-2 left-2 bg-black/50 px-2 py-1 rounded-md`}\n              >\n                <Text style={tw`text-white text-xs font-semibold`}>\n                  {formatDuration(duration)}\n                </Text>\n              </View>\n            </>\n          )}\n        </Pressable>\n      )}\n\n      {message.audio && (\n        <View style={tw`my-2`}>\n          <AudioPlayer\n            audioUrl={message.audio}\n            audioId={message.id}\n            isVideoPlaying={isVideoPlaying as boolean}\n          />\n        </View>\n      )}\n\n      {message.text && (\n        <Text\n          style={[\n            tw`text-gray-800 pt-1`,\n            showMessageStatus ? tw`pb-0` : tw`pb-2`,\n            { wordBreak: 'break-word', overflowWrap: 'break-word' },\n            theme?.messageStyle?.textStyle,\n          ]}\n        >\n          {message.text}\n        </Text>\n      )}\n    </View>\n  );\n};\n\nexport default React.memo(MessageContent);\n"],"names":["MessageContent","message","onMediaPress","isVideoPlaying","theme","showMessageStatus","CustomPlayIcon","renderCustomVideoBubbleError","useChatContext","videoRef","React","useRef","duration","setDuration","useState","videoIsLoading","setVideoIsLoading","videoHasError","setVideoHasError","_jsxs","View","children","image","_jsx","Pressable","onPress","style","tw","jsx","Image","source","uri","video","disabled","Video","ref","paused","width","height","borderRadius","position","resizeMode","onLoadStart","onLoad","data","onBuffer","isBuffering","onError","LoadingIcon","Text","jsxs","_Fragment","PlayIcon","color","colors","audioPlayIconColor","formatDuration","audio","AudioPlayer","audioUrl","audioId","id","text","wordBreak","overflowWrap","messageStyle","textStyle","MessageContent$1","memo"],"mappings":"qWAWA,MAAMA,EAAgDA,EACpDC,UACAC,eACAC,qBAEA,MAAMC,MACJA,EAAKC,kBACLA,EAAiBC,eACjBA,EAAcC,6BACdA,GACEC,mBACEC,EAAWC,EAAMC,OAAiB,OACjCC,EAAUC,GAAeH,EAAMI,SAAS,IACxCC,EAAgBC,GAAqBN,EAAMI,UAAS,IACpDG,EAAeC,GAAoBR,EAAMI,UAAS,GAEzD,OACEK,EAAAA,KAACC,EAAAA,KAAI,CAAAC,UACFpB,EAAQqB,OACPC,EAAAA,IAACC,EAAAA,UAAS,CACRC,QAASA,IAAMvB,EAAa,QAASD,EAAQqB,OAC7CI,MAAOC,CAAE,iBAAiBN,SAE1BE,EAAAK,IAACC,QAAK,CACJC,OAAQ,CAAEC,IAAK9B,EAAQqB,OACvBI,MAAOC,CAAE,8CAKd1B,EAAQ+B,OACPb,EAAAA,KAACK,EAAAA,UAAS,CACRC,QAASA,IAAMvB,EAAa,QAASD,EAAQ+B,OAC7CN,MAAOC,CAAE,6CACTM,SAAUlB,EAAeM,SAAA,CAEzBE,EAAAK,IAACM,EAAK,CACJJ,OAAQ,CAAEC,IAAK9B,EAAQ+B,OACvBG,IAAK1B,EACL2B,QAAQ,EACRV,MAAO,CACLW,MAAO,OACPC,OAAQ,OACRC,aAAc,EACdC,SAAU,YAEZC,WAAW,QACXC,YAAaA,KACX1B,GAAkB,GAClBE,GAAiB,EAAM,EAEzByB,OAASC,IACP/B,EAAY+B,EAAKhC,UACjBI,GAAkB,EAAM,EAE1B6B,SAAUA,EAAGC,iBAAkB9B,EAAkB8B,GACjDC,QAASA,KACP7B,GAAiB,GACjBF,GAAkB,EAAM,IAG3BD,EACCQ,EAAAK,IAACR,OAAI,CACHM,MAAOC,CAAE,6EAA6EN,SAEtFE,EAAAK,IAACoB,cAAW,CACVtB,MAAOC,EAAGD,MAAM,yCAGlBT,EACFV,EACEA,IAEAgB,EAAAA,IAACH,EAAAA,KAAI,CACHM,MAAOC,CAAE,sEAAsEN,SAE/EE,EAAAK,IAACqB,OAAI,CAACvB,MAAOC,CAAE,uBAAuBN,SAAC,2BAM3CF,EAAA+B,KAAAC,WAAA,CAAA9B,SAAA,CACEE,EAAAK,IAACR,OAAI,CAACM,MAAOC,CAAE,oCAAoCN,SAChDf,EACCiB,MAACjB,EAAc,CAAA,GAEfiB,EAAAK,IAACwB,WAAQ,CACP1B,MAAOC,EAAGD,MAAM,aAChB2B,MAAOjD,GAAOkD,QAAQC,oBAAsB,YAIlDhC,EAAAK,IAACR,OAAI,CACHM,MAAOC,CAAE,4DAA4DN,SAErEE,EAAAK,IAACqB,OAAI,CAACvB,MAAOC,CAAE,mCAAmCN,SAC/CmC,EAAcA,eAAC5C,aAQ3BX,EAAQwD,OACPlC,EAAAA,IAACH,EAAAA,KAAI,CAACM,MAAOC,CAAE,OAAON,SACpBE,EAAAK,IAAC8B,EAAW,CACVC,SAAU1D,EAAQwD,MAClBG,QAAS3D,EAAQ4D,GACjB1D,eAAgBA,MAKrBF,EAAQ6D,MACPvC,EAAAA,IAAC0B,EAAAA,KAAI,CACHvB,MAAO,CACLC,CAAE,qBACFtB,EAAoBsB,CAAE,OAASA,CAAE,OACjC,CAAEoC,UAAW,aAAcC,aAAc,cACzC5D,GAAO6D,cAAcC,WACrB7C,SAEDpB,EAAQ6D,SAGR,EAIX,IAAAK,EAAezD,EAAM0D,KAAKpE"}